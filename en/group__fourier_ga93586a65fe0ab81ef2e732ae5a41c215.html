<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libtsd: dsp::fourier::filter_fft</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libtsd
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">C++ signal processing library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="pageinstall.html"><span>Installation</span></a></li>
      <li><a href="pagelicence.html"><span>Licence</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__fourier_ga93586a65fe0ab81ef2e732ae5a41c215.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="contents">
<a id="ga93586a65fe0ab81ef2e732ae5a41c215"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga93586a65fe0ab81ef2e732ae5a41c215">&#9670;&nbsp;</a></span>filter_fft()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tuple&lt;sptr&lt;<a class="el" href="group__tsd_ga45923d187d821768b6fc6834f436a42b.html#ga45923d187d821768b6fc6834f436a42b">Filter</a>&lt;<a class="el" href="group__tsd.html#gaa8c330358a956022365d97b01ba56225">cfloat</a>, <a class="el" href="group__tsd.html#gaa8c330358a956022365d97b01ba56225">cfloat</a>, tsdF::FiltreFFTConfig&gt; &gt;, int&gt; dsp::fourier::filter_fft </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdsp_1_1fourier_1_1_f_f_t_filter_config.html">FFTFilterConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h3>Creation of frequency domain filter</h3>
<p>For different purposes, it can be convenient to apply filtering in the frequency domain rather than in the time domain, for instante to reduce the computing load. (time domain convolutions become simple term by term product in the frequency domain). By frequency domain filtering, we mean here to be able to adjust term by term the different bins of the DFT of a signal, and then to build the result in the time domain.</p>
<p>So as to work in the frequency domain, samples are grouped into blocks of \(N_e\) samples, and for each of these blocks the following operations are performed:</p><ul>
<li><b>Windowing and overlap</b> (optional): so as to smooth processings from one block to the next one, an apodisation window is applied (by default, a Hann window with an overlap of 50 %, so as to enable perfect reconstruction of the time domain signal).</li>
<li><b>Zero-padding</b> : So as to compute efficiently the FFT, zeros are inserted, making the length of each block equal to some power of 2. So, after zero-padding, the blocks length is \(N=2^k\geq N_e\).</li>
<li><b>Fourier transform:</b> through a FFT.</li>
<li><b>Frequency domain processing</b> : through a callback provided by the caller (see below).</li>
<li><b>Inverse Fourier transform</b>.</li>
<li><b>Recomposition of time domain blocks</b>: through the OLA technique (<em>OverLap-and-Add</em>).</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">config</td><td>Configuration structure (<a class="el" href="structdsp_1_1fourier_1_1_f_f_t_filter_config.html">FFTFilterConfig</a>) which specify:<ul>
<li>Dimension \(N_e\) of input time-domain blocks,</li>
<li>Minimal number of zeros to be inserted at the beginnning of each block,</li>
<li>User callback for frequency domain processing.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A tuple with two elements:<ul>
<li>the OLA filter,</li>
<li>an integer which is the dimension \(N\) of the FFT (that is, the dimension of the vectors that will be given to the callback).</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>For the more specific problem of efficient FIR filter computing (using the FFT), use rather <a class="el" href="group__filtrage-tr_gadc16401b313f3a5ff3c20ce244dcd319.html#gadc16401b313f3a5ff3c20ce244dcd319">filter_fir_fft()</a>, which is based on this function, and is simpler to use. </dd></dl>
<dl class="section user"><dt>Example: Low-pass filter</dt><dd>In this example, we low-pass filter a signal by simply zeroing half the spectrum. <div class="fragment"><div class="line">  soit n = 8192;</div>
<div class="line">  <span class="comment">// signal utile à f = 0.04 * fe Hz, et parasite à f=0.400 * fe Hz</span></div>
<div class="line">  soit x = (<a class="code" href="group__tsd-gen_ga12a7257648aeb0298365fdd1df349599.html#ga12a7257648aeb0298365fdd1df349599">sigsin</a>(0.004, n) + <a class="code" href="group__tsd-gen_ga12a7257648aeb0298365fdd1df349599.html#ga12a7257648aeb0298365fdd1df349599">sigsin</a>(0.4, n)).as&lt;cfloat&gt;();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  FiltreFFTConfig config;</div>
<div class="line">  <span class="comment">// Cette callback sera appelée à chaque itération de l&#39;OLA</span></div>
<div class="line">  config.traitement_freq = [&amp;](Veccf &amp;X)</div>
<div class="line">  {</div>
<div class="line">    tsd_assert(X.rows() == 512);</div>
<div class="line">    X.segment(128, 256).setZero();</div>
<div class="line">  };</div>
<div class="line">  config.dim_blocs_temporel   = 512;  <span class="comment">// Par bloc de 512 échantillons</span></div>
<div class="line">  config.nb_zeros_min         = 0;    <span class="comment">// Zéro-padding non nécessaire</span></div>
<div class="line">  config.avec_fenetrage       = oui;  <span class="comment">// Fenêtre de Hann et recouvrement de 50 %</span></div>
<div class="line"> </div>
<div class="line">  soit [ola, N] = filtre_fft(config);</div>
<div class="line">  soit y = real(ola-&gt;step(x));</div>
<div class="ttc" id="agroup__tsd-gen_ga12a7257648aeb0298365fdd1df349599_html_ga12a7257648aeb0298365fdd1df349599"><div class="ttname"><a href="group__tsd-gen_ga12a7257648aeb0298365fdd1df349599.html#ga12a7257648aeb0298365fdd1df349599">dsp::sigsin</a></div><div class="ttdeci">static Vecf sigsin(float f, int n)</div><div class="ttdoc">Efficient computing of a sinusoid.</div><div class="ttdef"><b>Definition:</b> dsp.hpp:903</div></div>
</div><!-- fragment --><div class="image">
<img src="ex-ola-pb.png" alt="" width="800px"/>
</div>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__filtrage-tr_gadc16401b313f3a5ff3c20ce244dcd319.html#gadc16401b313f3a5ff3c20ce244dcd319" title="Efficient implementation of a FIR filter in the frequency domain.">filter_fir_fft()</a>, filter_rfft(), <a class="el" href="group__fourier_ga3bc88eb0fea93349ca6ea29088dd5b8b.html#ga3bc88eb0fea93349ca6ea29088dd5b8b" title="Compute the complexity of an OLA filter, in FLOPS by input sample.">ola_complexity()</a>, <a class="el" href="group__fourier_gac3860c9e44768c6b4f413b464f66910b.html#gac3860c9e44768c6b4f413b464f66910b" title="Compute optimal parameters for an OLA filter.">ola_complexity_optimize()</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedsp.html">dsp</a></li><li class="navelem"><a class="el" href="namespacedsp_1_1fourier.html">fourier</a></li>
    <li class="footer">Generated on Tue May 2 2023 10:30:19 for libtsd by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
