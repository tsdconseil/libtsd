<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libtsd: dsp::fourier::detector_new</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libtsd
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">C++ signal processing library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="pageinstall.html"><span>Installation</span></a></li>
      <li><a href="pagelicence.html"><span>Licence</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__fourier-corr_ga089a06312af84b4b89a5101598da7185.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="contents">
<a id="ga089a06312af84b4b89a5101598da7185"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga089a06312af84b4b89a5101598da7185">&#9670;&nbsp;</a></span>detector_new()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__tsd.html#ga2bdb8287f8213bd4bcdd6a47a4886586">sptr</a>&lt;Detecteur&gt; dsp::fourier::detector_new </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdsp_1_1fourier_1_1_detector_config.html">DetectorConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em> = <code><a class="el" href="structdsp_1_1fourier_1_1_detector_config.html">DetectorConfig</a>()</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h3>Détecteur par corrélation</h3>
<p>Cette fonction calcule, au fil de l'eau, la corrélation normalisée entre un signal \((x_k)\) reçu en continu et un motif fixe \((h_k)\) de dimension \(M\) : </p><p class="formulaDsp">
\[ y_n = \frac{\left|\displaystyle{\sum_{k=0}^{M-1} x_{n+k-(M-1)} \cdot h_{k}^\star}\right|}{\displaystyle{ \sqrt{\left(\sum_{k=0}^{M-1}\left|x_{n+k-(M-1)}\right|^2\right) \left(\sum_{k=0}^{M-1}\left|h_k\right|^2\right)}}} \]
</p>
<p>Les \(y_n\) sont donc compris entre 0 et 1, et seront égaux à 1 uniquement si le signal est exactement égal au motif (à un facteur d'échelle constant près) sur l'intervalle \([n-M+1\dots n]\).</p>
<p>Le calcul étant fait de manière efficace dans le domaine fréquentiel via la technique Overlap-And-Add (voir <a class="el" href="group__fourier_ga883478d6eb519e2f0ff6823f6823ddcd.html#ga883478d6eb519e2f0ff6823f6823ddcd">filter_fft()</a>), la complexité est de l'ordre de \(\log_2 M\) opérations par échantillon (si \(M\) est une puissance de 2).</p>
<p>Ce filtre peut-être utilisé de deux manières :</p><ul>
<li>Tout d'abord, c'est un filtre qui renvoie, au fil de l'eau, les valeurs de corrélation (signal vert dans l'exemple ci-dessous),</li>
<li>Pour une utilisation plus simple, une callback utilisateur peut être appelée dès lors que la corrélation dépasse un certain seuil paramétrable. En paramètre de cette callback, est indiquée la position du motif détecté, ainsi que diverses informations (voir la structure <a class="el" href="structdsp_1_1fourier_1_1_detection.html">Detection</a>) :<ul>
<li>Valeur de la corrélation normalisée</li>
<li>Gain réel du signal (rapport d'amplitude entre le signal reçu et le motif théorique attendu)</li>
<li>Déphasage du signal reçu</li>
<li>Ecart-type du bruit</li>
<li>SNR estimé</li>
</ul>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">config</td><td>Structure de configuration </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Filtre cfloat \(\to\) float, qui prend en entrée des échantillons, et sort, au fil de l'eau, la corrélation normalisée avec le motif.</dd></dl>
<dl class="section user"><dt>Exemple</dt><dd><div class="fragment"><div class="line">  <span class="keywordtype">int</span> M = 512; <span class="comment">// Dimension du motif</span></div>
<div class="line">  <span class="keywordtype">int</span> N = 16*M; <span class="comment">// Dimension du signal</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Motif de synchronisation</span></div>
<div class="line">  ArrayXcf motif = <a class="code" href="group__tsd-gen_gaaa4d62d70c30c10e62b91bc7b3751e3a.html#gaaa4d62d70c30c10e62b91bc7b3751e3a">sigchirp2</a>(0.001, 0.2, M);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Signal = bruit</span></div>
<div class="line">  ArrayXcf x = 0.1 * <a class="code" href="group__tsd-gen_ga0900621a525834a05cf888939fd1998d.html#ga0900621a525834a05cf888939fd1998d">randn</a>(N);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// + motif à détecter au milieu</span></div>
<div class="line">  x.segment(900, M) = motif;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> pos_detection = 0;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//float C;</span></div>
<div class="line">  <span class="comment">//int Nf, Nz, Ne;</span></div>
<div class="line">  <span class="comment">//ola_complexite_optimise(M, C, Nf, Nz, Ne);</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  DetecteurConfig config;</div>
<div class="line">  config.motif  = motif;</div>
<div class="line">  config.Ne     = M;</div>
<div class="line">  config.gere_detection = [&amp;](<span class="keyword">const</span> DetecteurConfig::Detection &amp;det)</div>
<div class="line">  {</div>
<div class="line">    msg(<span class="stringliteral">&quot;Detection : {}.&quot;</span>, det);</div>
<div class="line">    pos_detection = det.position;</div>
<div class="line">  };</div>
<div class="line">  <span class="keyword">auto</span> det = détecteur_création(config);</div>
<div class="line">  ArrayXf y = det-&gt;step(x);</div>
<div class="line"> </div>
<div class="line">  Figures f;</div>
<div class="line">  f.subplot().plot(motif.real(), <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Motif à détecter&quot;</span>);</div>
<div class="line">  f.subplot().plot(x.real(), <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;x&quot;</span>);</div>
<div class="line">  f.gcf().def_rdi({0, -1, 8000, 2});</div>
<div class="line"> </div>
<div class="line">  f.gcf().canva().set_couleur(tsd::vue::Couleur::Vert);</div>
<div class="line">  f.gcf().canva().set_epaisseur(3);</div>
<div class="line">  f.gcf().canva().set_remplissage(<span class="keyword">false</span>);</div>
<div class="line">  f.gcf().canva().rectangle(pos_detection, 1, pos_detection + M - 1, -1);</div>
<div class="line"> </div>
<div class="ttc" id="agroup__tsd-gen_ga0900621a525834a05cf888939fd1998d_html_ga0900621a525834a05cf888939fd1998d"><div class="ttname"><a href="group__tsd-gen_ga0900621a525834a05cf888939fd1998d.html#ga0900621a525834a05cf888939fd1998d">dsp::randn</a></div><div class="ttdeci">static ArrayXf randn(unsigned int n)</div><div class="ttdoc">Normal law (column vector).</div><div class="ttdef"><b>Definition:</b> dsp.hpp:767</div></div>
<div class="ttc" id="agroup__tsd-gen_gaaa4d62d70c30c10e62b91bc7b3751e3a_html_gaaa4d62d70c30c10e62b91bc7b3751e3a"><div class="ttname"><a href="group__tsd-gen_gaaa4d62d70c30c10e62b91bc7b3751e3a.html#gaaa4d62d70c30c10e62b91bc7b3751e3a">dsp::sigchirp2</a></div><div class="ttdeci">ArrayXf sigchirp2(float f0, float f1, int n)</div><div class="ttdoc">Quadratic chirp.</div></div>
</div><!-- fragment --><div class="image">
<img src="fft_correlateur.png" alt="" width="800px"/>
</div>
 </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedsp.html">dsp</a></li><li class="navelem"><a class="el" href="namespacedsp_1_1fourier.html">fourier</a></li>
    <li class="footer">Generated on Thu Feb 3 2022 08:25:00 for libtsd by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
